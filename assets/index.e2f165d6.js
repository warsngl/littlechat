var B=Object.defineProperty,D=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var N=(e,t,s)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,z=(e,t)=>{for(var s in t||(t={}))V.call(t,s)&&N(e,s,t[s]);if(L)for(var s of L(t))j.call(t,s)&&N(e,s,t[s]);return e},A=(e,t)=>D(e,R(t));import{c as H,r as v,o as a,a as l,b as r,d as p,w as y,t as c,e as _,F as w,i as E,g as P,f as I,h as O,j as k,v as x,k as M,p as J,l as F,m as U,n as h,q as S,s as T,u as K,x as q,y as W,z as Y,A as G,B as Q}from"./vendor.a39029d7.js";const X=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))u(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&u(d)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}};X();const Z=H({state(){return{user:{name:"",id:"",count:0,onlineAt:"",rooms:[],messages:[]}}},mutations:{setUser(e,t){e.user=t},setUserProp(e,{prop:t,val:s}){e.user[t]=s},pushUserProps(e,{prop:t,val:s}){e.user[t].push(s)}}}),ee={class:"fa"},te=_("Rooms"),se={class:"px-4 border-b border-m4"},oe=_("Profile");function re(e,t,s,u,i,o){var n;const d=v("router-link");return a(),l("ul",ee,[r("li",null,[p(d,{to:"/"},{default:y(()=>[te]),_:1})]),r("li",null,[r("p",se,c(e.room||((n=e.$route.params)==null?void 0:n.id)||"Lobby"),1)]),r("li",null,[p(d,{to:"/user/"+e.user},{default:y(()=>[oe]),_:1},8,["to"])])])}var f=(e,t)=>{const s=e.__vccOpts||e;for(const[u,i]of t)s[u]=i;return s};const ne={};var ie=f(ne,[["render",re]]);function ae(e,t,s,u,i,o){const d=v("TheNavbar"),n=v("router-view");return a(),l(w,null,[p(d,{class:"w-full mb-4"}),p(n,{class:"mx-auto"})],64)}const le={components:{TheNavbar:ie},mounted(){let e=window.innerWidth,t=document.querySelector("html");e>750?t.style.fontSize=e/70+"px":t.style.fontSize="16px";let s=JSON.parse(localStorage.getItem("user"));!s||s=="undefined"?this.$router.push("login"):this.$store.commit("setUser",s)},beforeUnmount(){localStorage.setItem("user",JSON.stringify(this.user))}};var de=f(le,[["render",ae]]);const ue={apiKey:"AIzaSyD8pkb9OsLYohxINl6WKVf5G9VjgFDKRHo",authDomain:"a-little-chat.firebaseapp.com",databaseURL:"https://a-little-chat-default-rtdb.europe-west1.firebasedatabase.app",projectId:"a-little-chat",storageBucket:"a-little-chat.appspot.com",messagingSenderId:"191360084622",appId:"1:191360084622:web:cc0b9e3dd41a09879377df"};E(ue);const m=P();var g="https://warsngl.github.io/littlechat/assets/icon.b47e243f.svg";const b=e=>(J("data-v-1986e368"),e=e(),F(),e),he=g+"#lock",me=g+"#unlock",ce=g+"#deletechat",pe=g+"#edit",_e=g+"#delete",fe={key:0,class:"loader"},ge=b(()=>r("svg",{viewBox:"0 0 512 512"},[r("path",{d:"M304 48C304 74.51 282.5 96 256 96C229.5 96 208 74.51 208 48C208 21.49 229.5 0 256 0C282.5 0 304 21.49 304 48zM304 464C304 490.5 282.5 512 256 512C229.5 512 208 490.5 208 464C208 437.5 229.5 416 256 416C282.5 416 304 437.5 304 464zM0 256C0 229.5 21.49 208 48 208C74.51 208 96 229.5 96 256C96 282.5 74.51 304 48 304C21.49 304 0 282.5 0 256zM512 256C512 282.5 490.5 304 464 304C437.5 304 416 282.5 416 256C416 229.5 437.5 208 464 208C490.5 208 512 229.5 512 256zM74.98 437C56.23 418.3 56.23 387.9 74.98 369.1C93.73 350.4 124.1 350.4 142.9 369.1C161.6 387.9 161.6 418.3 142.9 437C124.1 455.8 93.73 455.8 74.98 437V437zM142.9 142.9C124.1 161.6 93.73 161.6 74.98 142.9C56.24 124.1 56.24 93.73 74.98 74.98C93.73 56.23 124.1 56.23 142.9 74.98C161.6 93.73 161.6 124.1 142.9 142.9zM369.1 369.1C387.9 350.4 418.3 350.4 437 369.1C455.8 387.9 455.8 418.3 437 437C418.3 455.8 387.9 455.8 369.1 437C350.4 418.3 350.4 387.9 369.1 369.1V369.1z"})],-1)),ve=[ge],ye={key:1,class:"relative fcc w-full h-full md:w-2/3"},be={key:0,class:"lock"},Ce={key:0,href:he},$e={key:1,href:me},we=b(()=>r("use",{href:ce},null,-1)),ke=[we],xe={class:"w-full overflow-y-auto"},Me=["onMouseover","onMouseleave"],Le={class:"flex"},Ne={class:"message"},ze={class:"relative"},Ae={key:0,class:"absolute edit"},Ie=["onClick"],Oe=b(()=>r("use",{href:pe},null,-1)),Ue=[Oe],Se=["onClick"],Ke=b(()=>r("use",{href:_e},null,-1)),Be=[Ke];function De(e,t,s,u,i,o){const d=v("router-link");return e.isLoading?(a(),l("div",fe,ve)):(a(),l("div",ye,[e.isAdmin?(a(),l("div",be,[(a(),l("svg",{class:"overflow-visible w-4",onClick:t[0]||(t[0]=(...n)=>o.handleLock&&o.handleLock(...n)),fill:"white"},[e.roomInfo.private?(a(),l("use",$e)):(a(),l("use",Ce))])),(a(),l("svg",{class:"ml-3 overflow-visible w-4",onClick:t[1]||(t[1]=(...n)=>o.deleteChat&&o.deleteChat(...n))},ke))])):I("",!0),r("ul",xe,[(a(!0),l(w,null,O(e.messages,(n,C)=>(a(),l("li",{class:"mb-2 bg-m4 text-m1 rounded-xl px-2 py-1",onMouseover:$=>e.hoverHub[C]=!0,onMouseleave:$=>e.hoverHub[C]=!1},[p(d,{class:"py-2 underline text-xs font-bold text-blue-400",to:"/user/"+n.user},{default:y(()=>[_(c(n.user),1)]),_:2},1032,["to"]),r("div",Le,[r("div",Ne,c(n.text),1),r("div",ze,[n.user==e.user&&e.hoverHub[C]?(a(),l("div",Ae,[(a(),l("svg",{class:"mr-2",onClick:$=>o.handleEditMessage(n)},Ue,8,Ie)),(a(),l("svg",{onClick:$=>o.deleteMessage(n)},Be,8,Se))])):I("",!0)])])],40,Me))),256))]),k(r("input",{class:"w-full rounded pl-3 text-m1","onUpdate:modelValue":t[2]||(t[2]=n=>e.text=n),placeholder:"Type message...",onKeydown:t[3]||(t[3]=M((...n)=>o.saveMessage&&o.saveMessage(...n),["enter"]))},null,544),[[x,e.text]])]))}const Re={data:()=>({roomInfo:{},text:"",messages:{},isLoading:!1,isAdmin:!1,isEdit:!1,message:{},hoverHub:[]}),computed:{someone(){return this.hoverHub[0]},getFullRoom(){let e;return this.getOne("rooms/"+this.room).then(t=>e=t),e}},methods:{getMessages(){this.isLoading=!0,U(h(m,"rooms/"+this.room),e=>{let t=e.val();if(t){this.roomInfo=t._info,this.isAdmin=t._info.users.includes(this.user)==1,this.messages=Object.keys(t).map(s=>A(z({},t[s]),{id:s})),this.messages.pop();for(let s=0;s<this.messages.length;s++)this.hoverHub.push(!1)}else this.messages=[{text:"No messages yet!",user:"Admin"}]}),this.isLoading=!1},deleteChat(){this.removeOne("rooms/"+this.room).then(e=>this.$router.push("/"))},handleLock(){let e=this.roomInfo.private;this.updateByKey("rooms",this.room,{_info:{users:this.user,private:!e}})},saveMessage(){this.isEdit?this.editMessage():this.sendMessage()},editMessage(){const{user:e,id:t}=this.message;this.updateByKey(`rooms/${this.room}`,t,{text:this.text,user:e}),this.text="",this.isEdit=!1},deleteMessage({id:e}){this.removeOne(`rooms/${this.room}/${e}`)},handleEditMessage(e){console.log(e),this.message=e,this.text=e.text,this.isEdit=!0},setRoomName(e){this.updateByKey("rooms/",this.room,{name:e})}},mounted(){this.getMessages()}};var Ve=f(Re,[["render",De],["__scopeId","data-v-1986e368"]]);const je={class:"flex"},He=_("Name");function Ee(e,t,s,u,i,o){return a(),l("div",je,[r("label",null,[He,k(r("input",{class:"rounded pl-2 mx-2 text-m1","onUpdate:modelValue":t[0]||(t[0]=d=>e.name=d),placeholder:"Enter name"},null,512),[[x,e.name]])]),r("button",{class:"bg-m3 px-2 border border-black text-m1",onClick:t[1]||(t[1]=(...d)=>o.enter&&o.enter(...d)),onKeydown:t[2]||(t[2]=M((...d)=>o.enter&&o.enter(...d),["enter"]))},"Join",32)])}const Pe={data:()=>({name:""}),methods:{enter(){this.$store.commit("setUserProp",{prop:"name",val:this.name}),this.$store.commit("setUserProp",{prop:"onlineAt",val:new Date});const e=this.getKey("users");this.$store.commit("setUserProp",{prop:"id",val:e}),this.$store.commit("setUserProp",{prop:"rooms",val:[]}),this.updateByKey("users/",e,this.fullUser),localStorage.setItem("user",JSON.stringify(this.fullUser)),this.$router.push("/")}}};var Je=f(Pe,[["render",Ee]]);const Fe=g+"#enter",Te={key:0,class:"loader"},qe=r("svg",{viewBox:"0 0 512 512"},[r("path",{d:"M304 48C304 74.51 282.5 96 256 96C229.5 96 208 74.51 208 48C208 21.49 229.5 0 256 0C282.5 0 304 21.49 304 48zM304 464C304 490.5 282.5 512 256 512C229.5 512 208 490.5 208 464C208 437.5 229.5 416 256 416C282.5 416 304 437.5 304 464zM0 256C0 229.5 21.49 208 48 208C74.51 208 96 229.5 96 256C96 282.5 74.51 304 48 304C21.49 304 0 282.5 0 256zM512 256C512 282.5 490.5 304 464 304C437.5 304 416 282.5 416 256C416 229.5 437.5 208 464 208C490.5 208 512 229.5 512 256zM74.98 437C56.23 418.3 56.23 387.9 74.98 369.1C93.73 350.4 124.1 350.4 142.9 369.1C161.6 387.9 161.6 418.3 142.9 437C124.1 455.8 93.73 455.8 74.98 437V437zM142.9 142.9C124.1 161.6 93.73 161.6 74.98 142.9C56.24 124.1 56.24 93.73 74.98 74.98C93.73 56.23 124.1 56.23 142.9 74.98C161.6 93.73 161.6 124.1 142.9 142.9zM369.1 369.1C387.9 350.4 418.3 350.4 437 369.1C455.8 387.9 455.8 418.3 437 437C418.3 455.8 387.9 455.8 369.1 437C350.4 418.3 350.4 387.9 369.1 369.1V369.1z"})],-1),We=[qe],Ye={key:1,class:"max-w-sm h-2/3"},Ge={class:"mb-2"},Qe={class:"fc mb-2"},Xe=r("svg",{class:"w-4 h-4",fill:"white"},[r("use",{href:Fe})],-1),Ze=[Xe],et={key:0},tt={key:1,class:"overflow-y-auto pr-4 h-full"},st={class:"mb-2 bg-m2 text-m3 rounded px-2 py-1 shadow shadow-m3"};function ot(e,t,s,u,i,o){const d=v("router-link");return e.isLoading?(a(),l("div",Te,We)):(a(),l("div",Ye,[r("div",Ge,[r("button",{class:"bg-m2 text-m4 w-full rounded border font-bold shadow-md shadow-green-600",onClick:t[0]||(t[0]=(...n)=>o.createRoom&&o.createRoom(...n))},"Create")]),r("div",Qe,[k(r("input",{class:"pl-2 rounded text-m1 shadow-md shadow-red-600 mr-2",placeholder:"Join private room","onUpdate:modelValue":t[1]||(t[1]=n=>e.id=n),onKeydown:t[2]||(t[2]=M((...n)=>o.join&&o.join(...n),["enter"]))},null,544),[[x,e.id]]),r("button",{onClick:t[3]||(t[3]=(...n)=>o.join&&o.join(...n))},Ze)]),e.rooms.length==0?(a(),l("h1",et,"No rooms yet!")):(a(),l("ul",tt,[(a(!0),l(w,null,O(e.rooms,n=>(a(),l("li",st,[p(d,{to:"/room/"+n.id},{default:y(()=>[_(c(n.id)+" by ",1)]),_:2},1032,["to"]),p(d,{class:"underline",to:"/user/"+n.user},{default:y(()=>[_(c(n.user),1)]),_:2},1032,["to"])]))),256))]))]))}const rt={data:()=>({rooms:[],id:"",isLoading:!1}),computed:{},methods:{getRooms(){this.isLoading=!0,U(h(m,"rooms"),e=>{let t=e.val();t&&(this.rooms=Object.keys(t).filter(s=>t[s]._info.private==!1||t[s]._info.users.includes(this.user)).map(s=>{let u=t[s]._info.users;return u=typeof u==String?u:u.split(",")[0],{id:s,user:u}}))}),this.isLoading=!1},createRoom2(){let e=this.add("rooms/-N0DQN0IE435taR2qqz8",{be:1,foo:!1});console.log(e)},createRoom(){let e=this.add("rooms/",{_info:{users:this.user,private:!1}});this.add("rooms/"+e,{text:"Hi there\u{1F525}",user:this.user}),this.add("users/"+this.fullUser.id+"/rooms/",e)},join(){let e;S(h(m,`${this.id}/_info/users`)).then(t=>{e=t.val(),T(h(m,this.id+"/_info/users"),`${e},${this.user}`)}),this.$router.push(this.id)}},mounted(){this.getRooms()}};var nt=f(rt,[["render",ot]]);const it={class:"max-w-sm text-center"},at={class:"flex text-left"},lt=r("div",{class:"w-24 mr-20 font-bold"},[r("p",null,"Name"),r("p",null,"Register at"),r("p",null,"Messages")],-1),dt={class:"w-50"};function ut(e,t,s,u,i,o){return a(),l("div",it,[r("button",{class:"mb-3 bg-m4 text-m1 px-2 py-1 rounded shadow shadow-yellow-400",onClick:t[0]||(t[0]=(...d)=>o.logout&&o.logout(...d))},"Logout"),r("div",at,[lt,r("div",dt,[r("p",null,c(e.target.name),1),r("p",null,c(o.onlineAt.day+" "+o.onlineAt.month+" "+o.onlineAt.year),1),r("p",null,c(e.target.count),1)])])])}const ht={data:()=>({target:{}}),computed:{profile(){return this.$route.params.id},onlineAt(){let e=new Date(this.target.onlineAt),t=e.getDate(),u=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],i=e.getFullYear();return{day:t,month:u,year:i}}},methods:{logout(){this.$router.push("/login")}},mounted(){this.getOne("users").then(e=>{Object.keys(e).forEach(t=>{e[t].name==this.profile&&(this.target=e[t])})})}};var mt=f(ht,[["render",ut]]),ct={data:()=>({}),computed:{user(){return this.$store.state.user.name},fullUser(){return this.$store.state.user},room(){return this.$route.params.roomID}},watch:{},methods:{getOne(e,t){return S(h(m,e)).then(s=>s.val())},add(e,t){return K(h(m,e),t).key},getKey(e){return K(h(m,e)).key},updateByKey(e,t,s){q(h(m,e+"/"+t),s)},removeOne(e){return W(h(m,e))},sendMessage(e=this.text,t=this.user){let s=new Date,u=this.add("rooms/"+this.room,{text:e,user:t,date:s});this.updateByKey("users/"+this.fullUser.id+"/messages",u,{text:e,user:t,date:s}),this.getOne("users/"+this.fullUser.id+"/count").then(i=>this.updateByKey("users",this.fullUser.id,{count:i+1})),this.text&&(this.text="")}}};const pt=[{path:"/",component:nt},{path:"/login",component:Je},{path:"/user/:id",component:mt},{path:"/user",redirect:"/"},{path:"/room",redirect:"/"},{path:"/room/:roomID",component:Ve}],_t=Y({history:G(),routes:pt});Q(de).use(_t).use(Z).mixin(ct).mount("#app");
